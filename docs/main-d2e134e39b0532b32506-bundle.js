(()=>{"use strict";var t,e={417:(t,e,i)=>{var n,r=i(500),o=(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),s=function(){function t(){}return t.prototype.midpoint=function(t,e){return null!=this.midpoint_weight?(console.log(this.midpoint_weight),new r.E9({x:this.midpoint_weight*t.x+(1-this.midpoint_weight)*e.x,y:this.midpoint_weight*t.y+(1-this.midpoint_weight)*e.y})):new r.E9({x:(t.x+e.x)/2,y:(t.y+e.y)/2})},t.prototype.render_pointarray=function(){return new r.VC(this.render().flatMap((function(t){return[t.x,t.y]})))},t.prototype.fractalize=function(t,e,i,n,o){var s=(0,r.Wj)().addTo("body").size(e,e);s.polyline(this.render_pointarray()).fill("none").stroke({color:"#000",width:i});for(var p=0,h=[[this,0]],a=function(){var e=h.pop(),r=e[0],o=e[1];if(p++,s.polyline(r.render_pointarray()).fill("none").stroke({color:"#000",width:i}),o<=t){var a=crypto.getRandomValues(new Uint32Array(1))[0]/Math.pow(2,32),u=r.step_options(n),c=Math.floor(a*u);h.push.apply(h,r.next_step(c,n).map((function(t){return[t,o+1]})))}};h.length;)a();return p},t}(),p=function(t){function e(e,i,n,r){var o=t.call(this)||this;return o.pt0=e,o.pt1=i,o.pt2=n,o.midpoint_weight=r,o}return o(e,t),e.prototype.render=function(){return[this.pt0,this.pt1,this.pt2]},e.prototype.rotate=function(){var t=[this.pt0,this.pt1,this.pt2];this.pt1=t[0],this.pt2=t[1],this.pt0=t[2]},e.prototype.trisect=function(){var t=this.pt0,i=this.pt1,n=this.pt2,r=this.midpoint(t,i),o=this.midpoint(i,n),s=this.midpoint(n,t);return[new e(t,r,s,this.midpoint_weight),new e(r,i,o,this.midpoint_weight),new e(s,o,n,this.midpoint_weight),new e(r,o,s,this.midpoint_weight)]},e.prototype.t_split=function(){var t=this.pt0,i=this.pt1,n=this.pt2,r=this.midpoint(t,i),o=this.midpoint(i,n),s=this.midpoint(n,t),p=this.midpoint(r,s);return[new e(t,r,s,this.midpoint_weight),new h(p,r,i,o,this.midpoint_weight),new h(s,p,o,n,this.midpoint_weight)]},e.prototype.step_options=function(t){return t?5:9},e.prototype.next_step=function(t,e){if(e)switch(t){case 0:return this.trisect();case 1:return this.t_split();case 2:return this.rotate(),this.t_split();case 3:return this.rotate(),this.rotate(),this.t_split();case 4:return[];default:throw new Error("next_step: index out of range")}else switch(t){case 0:case 1:case 2:return this.trisect();case 3:return this.t_split();case 4:return this.rotate(),this.t_split();case 5:return this.rotate(),this.rotate(),this.t_split();case 6:case 7:case 8:return[];default:throw new Error("next_step: index out of range")}},e}(s),h=function(t){function e(e,i,n,r,o){var s=t.call(this)||this;return s.pt0=e,s.pt1=i,s.pt2=n,s.pt3=r,s.midpoint_weight=o,s}return o(e,t),e.prototype.render=function(){return[this.pt0,this.pt1,this.pt2,this.pt3]},e.prototype.rotate=function(){var t=[this.pt0,this.pt1,this.pt2,this.pt3];this.pt1=t[0],this.pt2=t[1],this.pt3=t[2],this.pt0=t[3]},e.prototype.step_options=function(t){return 1},e.prototype.next_step=function(t,e){if(0===t)return[];throw new Error("next_step: index out of range")},e}(s),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.quadsect=function(){var t=this.pt0,i=this.pt1,n=this.pt2,r=this.pt3,o=this.midpoint(this.pt0,this.pt1),s=this.midpoint(this.pt1,this.pt2),h=this.midpoint(this.pt2,this.pt3),a=this.midpoint(this.pt3,this.pt0);return[new p(t,o,a,this.midpoint_weight),new p(o,i,s,this.midpoint_weight),new p(s,n,h,this.midpoint_weight),new p(a,h,r,this.midpoint_weight),new e(o,s,h,a,this.midpoint_weight)]},e.prototype.bisect=function(){var t=this.pt0,e=this.pt1,i=this.pt2,n=this.pt3;return[new p(t,e,i,this.midpoint_weight),new p(t,i,n,this.midpoint_weight)]},e.prototype.step_options=function(t){return t?4:6},e.prototype.next_step=function(t,e){if(e)switch(t){case 0:return this.quadsect();case 1:return this.bisect();case 2:return this.rotate(),this.bisect();case 3:return[];default:throw new Error("next_step: index out of range")}else switch(t){case 0:case 1:return this.quadsect();case 2:return this.bisect();case 3:return this.rotate(),this.bisect();case 4:case 5:return[];default:throw new Error("next_step: index out of range")}},e}(h);window.onload=function(){return t=this,e=void 0,n=function(){var t,e,i,n,o,s,p,h,u,c,l,f,d,w;return function(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:p(0),throw:p(1),return:p(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function p(p){return function(h){return function(p){if(i)throw new TypeError("Generator is already executing.");for(;o&&(o=0,p[0]&&(s=0)),s;)try{if(i=1,n&&(r=2&p[0]?n.return:p[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,p[1])).done)return r;switch(n=0,r&&(p=[2&p[0],r.value]),p[0]){case 0:case 1:r=p;break;case 4:return s.label++,{value:p[1],done:!1};case 5:s.label++,n=p[1],p=[0];continue;case 7:p=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==p[0]&&2!==p[0])){s=0;continue}if(3===p[0]&&(!r||p[1]>r[0]&&p[1]<r[3])){s.label=p[1];break}if(6===p[0]&&s.label<r[1]){s.label=r[1],r=p;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(p);break}r[2]&&s.ops.pop(),s.trys.pop();continue}p=e.call(t,s)}catch(t){p=[6,t],n=0}finally{i=r=0}if(5&p[0])throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}([p,h])}}}(this,(function(y){for(t=Math.min(window.innerHeight,window.innerWidth),console.log("pixel size:",t),e=new r.E9({x:0,y:t}),i=new r.E9({x:t,y:t}),n=new r.E9({x:t,y:0}),o=new r.E9({x:0,y:0}),s=new a(e,i,n,o,this.midpoint_weight),p=new URLSearchParams(window.location.search),(h=Number(p.get("depth")))||(h=3),(u=Number(p.get("stroke")))||(u=3),c=p.get("midpoint"),l=Number(c),f=p.get("uniform"),d=!f||"t"==f,console.log("max_depth:",h),console.log("stroke_width:",u),console.log("midpoint_weight:",l),console.log("uniform_weights:",d),w=s.fractalize(h,t,u,d,l),console.log("num_shapes",w);w<2;)document.body.removeChild(document.body.children[0]),w=s.fractalize(h,t,u,d,l),console.log("num_shapes",w);return[2]}))},new((i=void 0)||(i=Promise))((function(r,o){function s(t){try{h(n.next(t))}catch(t){o(t)}}function p(t){try{h(n.throw(t))}catch(t){o(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,p)}h((n=n.apply(t,e||[])).next())}));var t,e,i,n}}},i={};function n(t){var r=i[t];if(void 0!==r)return r.exports;var o=i[t]={exports:{}};return e[t](o,o.exports,n),o.exports}n.m=e,t=[],n.O=(e,i,r,o)=>{if(!i){var s=1/0;for(u=0;u<t.length;u++){for(var[i,r,o]=t[u],p=!0,h=0;h<i.length;h++)(!1&o||s>=o)&&Object.keys(n.O).every((t=>n.O[t](i[h])))?i.splice(h--,1):(p=!1,o<s&&(s=o));if(p){t.splice(u--,1);var a=r();void 0!==a&&(e=a)}}return e}o=o||0;for(var u=t.length;u>0&&t[u-1][2]>o;u--)t[u]=t[u-1];t[u]=[i,r,o]},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t={179:0};n.O.j=e=>0===t[e];var e=(e,i)=>{var r,o,[s,p,h]=i,a=0;if(s.some((e=>0!==t[e]))){for(r in p)n.o(p,r)&&(n.m[r]=p[r]);if(h)var u=h(n)}for(e&&e(i);a<s.length;a++)o=s[a],n.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return n.O(u)},i=self.webpackChunksquare_fractal=self.webpackChunksquare_fractal||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))})();var r=n.O(void 0,[500],(()=>n(417)));r=n.O(r)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QWlCQyxJQUFZRCxFQUFnQkMsSUFDckVELEVBQWdCQyxHQUFTLEtBRTFCRCxFQUFnQkMsR0FBVyxFQUU1QixPQUFPbkMsRUFBb0JRLEVBQUVDLEVBQU8sRUFHakNrQyxFQUFxQkMsS0FBaUMsMkJBQUlBLEtBQWlDLDRCQUFLLEdBQ3BHRCxFQUFtQkUsUUFBUVQsRUFBcUJVLEtBQUssS0FBTSxJQUMzREgsRUFBbUJ6RixLQUFPa0YsRUFBcUJVLEtBQUssS0FBTUgsRUFBbUJ6RixLQUFLNEYsS0FBS0gsRyxLQzdDdkYsSUFBSUksRUFBc0IvQyxFQUFvQlEsT0FBRUwsRUFBVyxDQUFDLE1BQU0sSUFBT0gsRUFBb0IsT0FDN0YrQyxFQUFzQi9DLEVBQW9CUSxFQUFFdUMsRSIsInNvdXJjZXMiOlsid2VicGFjazovL3NxdWFyZS1mcmFjdGFsL3dlYnBhY2svcnVudGltZS9jaHVuayBsb2FkZWQiLCJ3ZWJwYWNrOi8vc3F1YXJlLWZyYWN0YWwvLi9mcmFjdGFsLnRzIiwid2VicGFjazovL3NxdWFyZS1mcmFjdGFsL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NxdWFyZS1mcmFjdGFsL3dlYnBhY2svcnVudGltZS9kZWZpbmUgcHJvcGVydHkgZ2V0dGVycyIsIndlYnBhY2s6Ly9zcXVhcmUtZnJhY3RhbC93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3NxdWFyZS1mcmFjdGFsL3dlYnBhY2svcnVudGltZS9qc29ucCBjaHVuayBsb2FkaW5nIiwid2VicGFjazovL3NxdWFyZS1mcmFjdGFsL3dlYnBhY2svc3RhcnR1cCJdLCJzb3VyY2VzQ29udGVudCI6WyJ2YXIgZGVmZXJyZWQgPSBbXTtcbl9fd2VicGFja19yZXF1aXJlX18uTyA9IChyZXN1bHQsIGNodW5rSWRzLCBmbiwgcHJpb3JpdHkpID0+IHtcblx0aWYoY2h1bmtJZHMpIHtcblx0XHRwcmlvcml0eSA9IHByaW9yaXR5IHx8IDA7XG5cdFx0Zm9yKHZhciBpID0gZGVmZXJyZWQubGVuZ3RoOyBpID4gMCAmJiBkZWZlcnJlZFtpIC0gMV1bMl0gPiBwcmlvcml0eTsgaS0tKSBkZWZlcnJlZFtpXSA9IGRlZmVycmVkW2kgLSAxXTtcblx0XHRkZWZlcnJlZFtpXSA9IFtjaHVua0lkcywgZm4sIHByaW9yaXR5XTtcblx0XHRyZXR1cm47XG5cdH1cblx0dmFyIG5vdEZ1bGZpbGxlZCA9IEluZmluaXR5O1xuXHRmb3IgKHZhciBpID0gMDsgaSA8IGRlZmVycmVkLmxlbmd0aDsgaSsrKSB7XG5cdFx0dmFyIFtjaHVua0lkcywgZm4sIHByaW9yaXR5XSA9IGRlZmVycmVkW2ldO1xuXHRcdHZhciBmdWxmaWxsZWQgPSB0cnVlO1xuXHRcdGZvciAodmFyIGogPSAwOyBqIDwgY2h1bmtJZHMubGVuZ3RoOyBqKyspIHtcblx0XHRcdGlmICgocHJpb3JpdHkgJiAxID09PSAwIHx8IG5vdEZ1bGZpbGxlZCA+PSBwcmlvcml0eSkgJiYgT2JqZWN0LmtleXMoX193ZWJwYWNrX3JlcXVpcmVfXy5PKS5ldmVyeSgoa2V5KSA9PiAoX193ZWJwYWNrX3JlcXVpcmVfXy5PW2tleV0oY2h1bmtJZHNbal0pKSkpIHtcblx0XHRcdFx0Y2h1bmtJZHMuc3BsaWNlKGotLSwgMSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRmdWxmaWxsZWQgPSBmYWxzZTtcblx0XHRcdFx0aWYocHJpb3JpdHkgPCBub3RGdWxmaWxsZWQpIG5vdEZ1bGZpbGxlZCA9IHByaW9yaXR5O1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZihmdWxmaWxsZWQpIHtcblx0XHRcdGRlZmVycmVkLnNwbGljZShpLS0sIDEpXG5cdFx0XHR2YXIgciA9IGZuKCk7XG5cdFx0XHRpZiAociAhPT0gdW5kZWZpbmVkKSByZXN1bHQgPSByO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTsiLCJpbXBvcnQgeyBTVkcsIFBvaW50LCBQb2ludEFycmF5IH0gZnJvbSAnQHN2Z2RvdGpzL3N2Zy5qcydcblxuLy8gVE9ETzpcbi8vIC0gY2hhbmdlIHdlaWdodHNcbi8vIC0gY2hhbmdlIG1pZHBvaW50IGZyYWN0aW9uXG5cbi8vIHNxdWFyZSBmcmFjdGFsOlxuLy8gLSBzdGFydCB3aXRoIGEgc3F1YXJlXG4vLyAtIGVhY2ggc2hhcGUgY2FuIGJlOlxuLy8gICArIHNxdWFyZVxuLy8gICAgICogc3F1YXJlIGluc2lkZVxuLy8gICAgICogc3BsaXQgaW50byB0d28gdHJpYW5nbGVzIHR3byB3YXlzXG4vLyAgICAgKiBsZWF2ZSBlbXB0eVxuLy8gICArIHRyaWFuZ2xlXG4vLyAgICAgKiB0cmlhbmdsZSBpbnNpZGVcbi8vICAgICAqIHNwbGl0IGludG8gXCJUXCI6IHRyaWFuZ2xlIGFuZCB0d28gfnJob21idXMnXG4vLyAgICsgcmhvbWJ1c1xuLy8gICAgICogbGVhdmUgZW1wdHlcbi8vXG4vLyBzbyB3ZSBlaXRoZXI6XG4vLyAgIDEuIHRha2UgdGhlIGlucHV0IChOKSBhcyBhIG1peGVkLWJhc2Ugc2VlZFxuLy8gICAyLiBwaWNrIHJhbmRvbWx5IGVhY2ggc3RlcFxuLy9cbi8vIHR3byBsaXN0czpcbi8vIC0gbm9uLWRvbmUgcXVldWUgKHRyaWFuZ2xlIHwgc3F1YXJlKVxuLy8gLSBkb25lIHF1ZXVlICh0cmlhbmdsZSB8IHNxdWFyZSB8IH5yaG9tYnVzKVxuLy9cbi8vIGZpbmFsbHksIHJlbmRlciB0cmlhbmdsZXxzcXVhcmV8cmhvbWJ1cyAtPiBTVkdcblxuYWJzdHJhY3QgY2xhc3MgU2hhcGUge1xuICBhYnN0cmFjdCBtaWRwb2ludF93ZWlnaHQ6IG51bWJlciB8IG51bGw7XG5cbiAgbWlkcG9pbnQoeHM6IFBvaW50LCB5czogUG9pbnQpOiBQb2ludCB7XG4gICAgaWYgKHRoaXMubWlkcG9pbnRfd2VpZ2h0ICE9IG51bGwpIHtcbiAgICAgIGNvbnNvbGUubG9nKHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcbiAgICAgIHJldHVybiBuZXcgUG9pbnQoe1xuICAgICAgICB4OiB0aGlzLm1pZHBvaW50X3dlaWdodCAqIHhzLnggKyAoMSAtIHRoaXMubWlkcG9pbnRfd2VpZ2h0KSAqIHlzLngsXG4gICAgICAgIHk6IHRoaXMubWlkcG9pbnRfd2VpZ2h0ICogeHMueSArICgxIC0gdGhpcy5taWRwb2ludF93ZWlnaHQpICogeXMueSxcbiAgICAgIH0pXG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBuZXcgUG9pbnQoe1xuICAgICAgICB4OiAoeHMueCArIHlzLngpIC8gMixcbiAgICAgICAgeTogKHhzLnkgKyB5cy55KSAvIDIsXG4gICAgICB9KVxuICAgIH1cbiAgfVxuXG4gIGFic3RyYWN0IHJlbmRlcigpOiBQb2ludFtdO1xuXG4gIGFic3RyYWN0IHJvdGF0ZSgpOiB2b2lkO1xuXG4gIGFic3RyYWN0IHN0ZXBfb3B0aW9ucyh1bmlmb3JtX3dlaWdodHM6IGJvb2xlYW4pOiBudW1iZXI7XG5cbiAgYWJzdHJhY3QgbmV4dF9zdGVwKGluZGV4OiBudW1iZXIsIHVuaWZvcm1fd2VpZ2h0czogYm9vbGVhbik6IFNoYXBlW107XG5cbiAgcmVuZGVyX3BvaW50YXJyYXkoKTogUG9pbnRBcnJheSB7XG4gICAgcmV0dXJuIG5ldyBQb2ludEFycmF5KHRoaXMucmVuZGVyKCkuZmxhdE1hcCgocHQpID0+IHtyZXR1cm4gW3B0LngsIHB0LnldfSkpO1xuICB9XG5cbiAgLy8gcmV0dXJucyB0aGUgbnVtYmVyIG9mIHN1Yi1zaGFwZXMgZHJhd25cbiAgZnJhY3RhbGl6ZShcbiAgICBtYXhfZGVwdGg6IG51bWJlcixcbiAgICBwaXhlbF9zaXplOiBudW1iZXIsXG4gICAgc3Ryb2tlX3dpZHRoOiBudW1iZXIsXG4gICAgdW5pZm9ybV93ZWlnaHRzOiBib29sZWFuLFxuICAgIG1pZHBvaW50X3dlaWdodDogbnVtYmVyIHwgdW5kZWZpbmVkLFxuICAgIC8vIGJvcmRlcl9waXhlbHM6IG51bWJlciwgLy8gVE9ETyA/XG4gICk6IG51bWJlciB7XG4gICAgdmFyIGRyYXcgPSBTVkcoKS5hZGRUbygnYm9keScpLnNpemUocGl4ZWxfc2l6ZSwgcGl4ZWxfc2l6ZSk7XG4gICAgZHJhdy5wb2x5bGluZSh0aGlzLnJlbmRlcl9wb2ludGFycmF5KCkpLmZpbGwoJ25vbmUnKS5zdHJva2UoeyBjb2xvcjogJyMwMDAnLCB3aWR0aDogc3Ryb2tlX3dpZHRoIH0pO1xuXG4gICAgLy8gW3NoYXBlLCBkZXB0aF1cbiAgICB2YXIgbnVtX3N1Yl9zaGFwZXMgPSAwO1xuICAgIHZhciB1bmZpbmlzaGVkX3NoYXBlczogW1NoYXBlLCBudW1iZXJdW10gPSBbW3RoaXMsIDBdXTtcbiAgICB3aGlsZSAodW5maW5pc2hlZF9zaGFwZXMubGVuZ3RoKSB7XG4gICAgICBsZXQgW2N1cnJlbnRfc2hhcGUsIGN1cnJlbnRfZGVwdGhdID0gdW5maW5pc2hlZF9zaGFwZXMucG9wKCk7XG4gICAgICBudW1fc3ViX3NoYXBlcysrO1xuICAgICAgZHJhdy5wb2x5bGluZShjdXJyZW50X3NoYXBlLnJlbmRlcl9wb2ludGFycmF5KCkpLmZpbGwoJ25vbmUnKS5zdHJva2UoeyBjb2xvcjogJyMwMDAnLCB3aWR0aDogc3Ryb2tlX3dpZHRoIH0pO1xuXG4gICAgICBpZiAoY3VycmVudF9kZXB0aCA8PSBtYXhfZGVwdGgpIHtcbiAgICAgICAgbGV0IG5leHRfcmFuZG9tX251bSA9IGNyeXB0by5nZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQzMkFycmF5KDEpKVswXS8yKiozMjtcbiAgICAgICAgbGV0IG1heCA9IGN1cnJlbnRfc2hhcGUuc3RlcF9vcHRpb25zKHVuaWZvcm1fd2VpZ2h0cyk7XG4gICAgICAgIGxldCBuZXh0X3N0ZXBfaW5kZXggPSBNYXRoLmZsb29yKG5leHRfcmFuZG9tX251bSAqIG1heCk7XG4gICAgICAgIHVuZmluaXNoZWRfc2hhcGVzLnB1c2goLi4uY3VycmVudF9zaGFwZS5uZXh0X3N0ZXAobmV4dF9zdGVwX2luZGV4LCB1bmlmb3JtX3dlaWdodHMpLm1hcCgoeCkgPT4ge1xuICAgICAgICAgIGxldCByZXQ6IFtTaGFwZSwgbnVtYmVyXSA9IFt4LCBjdXJyZW50X2RlcHRoICsgMV07XG4gICAgICAgICAgcmV0dXJuIHJldFxuICAgICAgICB9KSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG51bV9zdWJfc2hhcGVzXG4gIH1cblxufVxuXG5cbmNsYXNzIFRyaWFuZ2xlIGV4dGVuZHMgU2hhcGUge1xuICBtaWRwb2ludF93ZWlnaHQ6IG51bWJlciB8IG51bGw7XG4gIHB0MDogUG9pbnQ7XG4gIHB0MTogUG9pbnQ7XG4gIHB0MjogUG9pbnQ7XG5cbiAgY29uc3RydWN0b3IocHQwOiBQb2ludCwgcHQxOiBQb2ludCwgcHQyOiBQb2ludCwgbWlkcG9pbnRfd2VpZ2h0OiBudW1iZXIgfCBudWxsKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLnB0MCA9IHB0MDtcbiAgICB0aGlzLnB0MSA9IHB0MTtcbiAgICB0aGlzLnB0MiA9IHB0MjtcbiAgICB0aGlzLm1pZHBvaW50X3dlaWdodCA9IG1pZHBvaW50X3dlaWdodDtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gW3RoaXMucHQwLCB0aGlzLnB0MSwgdGhpcy5wdDJdXG4gIH1cblxuICByb3RhdGUoKSB7XG4gICAgbGV0IHBvaW50cyA9IFt0aGlzLnB0MCwgdGhpcy5wdDEsIHRoaXMucHQyXTtcbiAgICBbdGhpcy5wdDEsIHRoaXMucHQyLCB0aGlzLnB0MF0gPSBwb2ludHM7XG4gIH1cblxuICAvLyBwMFxuICAvLyB8XFxcbiAgLy8gfCBcXFxuICAvLyB8ICBcXFxuICAvLyB8ICAgXFxcbiAgLy8gfCBBICBcXFxuICAvLyB8ICAgICBcXFxuICAvLyB8PHAyMF9fXFwgPHAwMVxuICAvLyB8IFxcIE0gIC9cXFxuICAvLyB8ICBcXCAgLyAgXFxcbiAgLy8gfCBDIFxcLyBCICBcXFxuICAvLyAtLS0tLS0tLS0tLSBwMVxuICAvLyBwMiAgIHAxMlxuICB0cmlzZWN0KCk6IFtUcmlhbmdsZSwgVHJpYW5nbGUsIFRyaWFuZ2xlLCBUcmlhbmdsZV0ge1xuICAgIGxldCBwdDAgPSB0aGlzLnB0MDtcbiAgICBsZXQgcHQxID0gdGhpcy5wdDE7XG4gICAgbGV0IHB0MiA9IHRoaXMucHQyO1xuXG4gICAgbGV0IHB0MDEgPSB0aGlzLm1pZHBvaW50KHB0MCwgcHQxKTtcbiAgICBsZXQgcHQxMiA9IHRoaXMubWlkcG9pbnQocHQxLCBwdDIpO1xuICAgIGxldCBwdDIwID0gdGhpcy5taWRwb2ludChwdDIsIHB0MCk7XG5cbiAgICBsZXQgdHJpYW5nbGVfQSA9IG5ldyBUcmlhbmdsZShwdDAsIHB0MDEsIHB0MjAsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcbiAgICBsZXQgdHJpYW5nbGVfQiA9IG5ldyBUcmlhbmdsZShwdDAxLCBwdDEsIHB0MTIsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcbiAgICBsZXQgdHJpYW5nbGVfQyA9IG5ldyBUcmlhbmdsZShwdDIwLCBwdDEyLCBwdDIsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcbiAgICBsZXQgdHJpYW5nbGVfTSA9IG5ldyBUcmlhbmdsZShwdDAxLCBwdDEyLCBwdDIwLCB0aGlzLm1pZHBvaW50X3dlaWdodCk7XG5cbiAgICByZXR1cm4gW1xuICAgICAgdHJpYW5nbGVfQSxcbiAgICAgIHRyaWFuZ2xlX0IsXG4gICAgICB0cmlhbmdsZV9DLFxuICAgICAgdHJpYW5nbGVfTV1cbiAgfVxuXG4gIC8vICAgICBwMFxuICAvLyAgICAgfFxcXG4gIC8vICAgICB8IFxcXG4gIC8vICAgICB8ICBcXFxuICAvLyAgICAgfCAgIFxcXG4gIC8vICAgICB8IEEgIFxcXG4gIC8vICAgICB8ICAgICBcXFxuICAvLyBwMjA+fF9wMjAxX1xcIDxwMDFcbiAgLy8gICAgIHwgICB8ICAgXFxcbiAgLy8gICAgIHwgQyB8IEIgIFxcXG4gIC8vICAgICB8ICAgfCAgICAgXFxcbiAgLy8gICAgIC0tLS0tLS0tLS0tIHAxXG4gIC8vIHAyICAgcDEyXG4gIHRfc3BsaXQoKTogW1RyaWFuZ2xlLCBRdWFkcmlsYXRlcmFsLCBRdWFkcmlsYXRlcmFsXSB7XG4gICAgbGV0IHB0MCA9IHRoaXMucHQwO1xuICAgIGxldCBwdDEgPSB0aGlzLnB0MTtcbiAgICBsZXQgcHQyID0gdGhpcy5wdDI7XG5cbiAgICBsZXQgcHQwMSA9IHRoaXMubWlkcG9pbnQocHQwLCBwdDEpO1xuICAgIGxldCBwdDEyID0gdGhpcy5taWRwb2ludChwdDEsIHB0Mik7XG4gICAgbGV0IHB0MjAgPSB0aGlzLm1pZHBvaW50KHB0MiwgcHQwKTtcbiAgICBsZXQgcHQyMDEgPSB0aGlzLm1pZHBvaW50KHB0MDEsIHB0MjApO1xuXG4gICAgbGV0IHRyaWFuZ2xlX0EgPSBuZXcgVHJpYW5nbGUocHQwLCBwdDAxLCBwdDIwLCB0aGlzLm1pZHBvaW50X3dlaWdodCk7XG4gICAgbGV0IHF1YWRyaWxhdGVyYWxfQiA9IG5ldyBRdWFkcmlsYXRlcmFsKHB0MjAxLCBwdDAxLCBwdDEsIHB0MTIsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcbiAgICBsZXQgcXVhZHJpbGF0ZXJhbF9DID0gbmV3IFF1YWRyaWxhdGVyYWwocHQyMCwgcHQyMDEsIHB0MTIsIHB0MiwgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIHRyaWFuZ2xlX0EsXG4gICAgICBxdWFkcmlsYXRlcmFsX0IsXG4gICAgICBxdWFkcmlsYXRlcmFsX0NdXG4gIH1cblxuICBzdGVwX29wdGlvbnModW5pZm9ybV93ZWlnaHRzOiBib29sZWFuKSB7XG4gICAgaWYgKHVuaWZvcm1fd2VpZ2h0cykge1xuICAgICAgcmV0dXJuIDVcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIDlcbiAgICB9XG4gIH1cblxuICBuZXh0X3N0ZXAoaW5kZXg6IG51bWJlciwgdW5pZm9ybV93ZWlnaHRzOiBib29sZWFuKTogU2hhcGVbXSB7XG4gICAgaWYgKHVuaWZvcm1fd2VpZ2h0cykge1xuICAgICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgICAgcmV0dXJuIHRoaXMudHJpc2VjdCgpXG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICByZXR1cm4gdGhpcy50X3NwbGl0KClcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHRoaXMucm90YXRlKCk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMudF9zcGxpdCgpXG4gICAgICAgIGNhc2UgMzpcbiAgICAgICAgICB0aGlzLnJvdGF0ZSgpO1xuICAgICAgICAgIHRoaXMucm90YXRlKCk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMudF9zcGxpdCgpXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ25leHRfc3RlcDogaW5kZXggb3V0IG9mIHJhbmdlJylcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgICBjYXNlIDA6XG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgY2FzZSAyOlxuICAgICAgICAgIHJldHVybiB0aGlzLnRyaXNlY3QoKVxuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgcmV0dXJuIHRoaXMudF9zcGxpdCgpXG4gICAgICAgIGNhc2UgNDpcbiAgICAgICAgICB0aGlzLnJvdGF0ZSgpO1xuICAgICAgICAgIHJldHVybiB0aGlzLnRfc3BsaXQoKVxuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgdGhpcy5yb3RhdGUoKTtcbiAgICAgICAgICB0aGlzLnJvdGF0ZSgpO1xuICAgICAgICAgIHJldHVybiB0aGlzLnRfc3BsaXQoKVxuICAgICAgICBjYXNlIDY6XG4gICAgICAgIGNhc2UgNzpcbiAgICAgICAgY2FzZSA4OlxuICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignbmV4dF9zdGVwOiBpbmRleCBvdXQgb2YgcmFuZ2UnKVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG59XG5cblxuY2xhc3MgUXVhZHJpbGF0ZXJhbCBleHRlbmRzIFNoYXBlIHtcbiAgbWlkcG9pbnRfd2VpZ2h0OiBudW1iZXIgfCBudWxsO1xuICBwdDA6IFBvaW50O1xuICBwdDE6IFBvaW50O1xuICBwdDI6IFBvaW50O1xuICBwdDM6IFBvaW50O1xuXG4gIGNvbnN0cnVjdG9yKHB0MDogUG9pbnQsIHB0MTogUG9pbnQsIHB0MjogUG9pbnQsIHB0MzogUG9pbnQsIG1pZHBvaW50X3dlaWdodDogbnVtYmVyIHwgbnVsbCkge1xuICAgIHN1cGVyKCk7XG4gICAgdGhpcy5wdDAgPSBwdDA7XG4gICAgdGhpcy5wdDEgPSBwdDE7XG4gICAgdGhpcy5wdDIgPSBwdDI7XG4gICAgdGhpcy5wdDMgPSBwdDM7XG4gICAgdGhpcy5taWRwb2ludF93ZWlnaHQgPSBtaWRwb2ludF93ZWlnaHQ7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgcmV0dXJuIFt0aGlzLnB0MCwgdGhpcy5wdDEsIHRoaXMucHQyLCB0aGlzLnB0M11cbiAgfVxuXG4gIHJvdGF0ZSgpIHtcbiAgICBsZXQgcG9pbnRzID0gW3RoaXMucHQwLCB0aGlzLnB0MSwgdGhpcy5wdDIsIHRoaXMucHQzXTtcbiAgICBbdGhpcy5wdDEsIHRoaXMucHQyLCB0aGlzLnB0MywgdGhpcy5wdDBdID0gcG9pbnRzO1xuICB9XG5cbiAgc3RlcF9vcHRpb25zKHVuaWZvcm1fd2VpZ2h0czogYm9vbGVhbikge1xuICAgIHJldHVybiAxXG4gIH1cblxuICBuZXh0X3N0ZXAoaW5kZXg6IG51bWJlciwgdW5pZm9ybV93ZWlnaHRzOiBib29sZWFuKTogU2hhcGVbXSB7XG4gICAgc3dpdGNoIChpbmRleCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gW11cbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignbmV4dF9zdGVwOiBpbmRleCBvdXQgb2YgcmFuZ2UnKVxuICAgIH1cbiAgfVxuXG59XG5cblxuY2xhc3MgU3F1YXJlIGV4dGVuZHMgUXVhZHJpbGF0ZXJhbCB7XG5cbiAgLy8gICAgIHAwICAgICBwMDEgICAgICBwMVxuICAvLyAgICAgX19fX19fX19fX19fX19fX19cbiAgLy8gICAgIHwgICAgICAvIFxcICAgICAgfFxuICAvLyAgICAgfCBBICAgLyAgIFxcICBCICB8XG4gIC8vICAgICB8ICAgIC8gICAgIFxcICAgIHxcbiAgLy8gICAgIHwgICAvICAgICAgIFxcICAgfFxuICAvLyAgICAgfCAgLyAgICAgICAgIFxcICB8XG4gIC8vICAgICB8IC8gICAgICAgICAgIFxcIHxcbiAgLy8gcDMwIHwvICAgICAgTSAgICAgIFxcfCBwMTJcbiAgLy8gICAgIHxcXCAgICAgICAgICAgICAvfFxuICAvLyAgICAgfCBcXCAgICAgICAgICAgLyB8XG4gIC8vICAgICB8ICBcXCAgICAgICAgIC8gIHxcbiAgLy8gICAgIHwgICBcXCAgICAgICAvICAgfFxuICAvLyAgICAgfCAgICBcXCAgICAgLyAgICB8XG4gIC8vICAgICB8IEQgICBcXCAgIC8gIEMgIHxcbiAgLy8gICAgIHwgICAgICBcXCAvICAgICAgfFxuICAvLyAgICAgfC0tLS0tLS0tLS0tLS0tLXwgcDJcbiAgLy8gICAgIHAzICAgICBwMjNcbiAgcXVhZHNlY3QoKTogW1RyaWFuZ2xlLCBUcmlhbmdsZSwgVHJpYW5nbGUsIFRyaWFuZ2xlLCBTcXVhcmVdIHtcbiAgICBsZXQgcHQwID0gdGhpcy5wdDA7XG4gICAgbGV0IHB0MSA9IHRoaXMucHQxO1xuICAgIGxldCBwdDIgPSB0aGlzLnB0MjtcbiAgICBsZXQgcHQzID0gdGhpcy5wdDM7XG5cbiAgICBsZXQgcHQwMSA9IHRoaXMubWlkcG9pbnQodGhpcy5wdDAsIHRoaXMucHQxKTtcbiAgICBsZXQgcHQxMiA9IHRoaXMubWlkcG9pbnQodGhpcy5wdDEsIHRoaXMucHQyKTtcbiAgICBsZXQgcHQyMyA9IHRoaXMubWlkcG9pbnQodGhpcy5wdDIsIHRoaXMucHQzKTtcbiAgICBsZXQgcHQzMCA9IHRoaXMubWlkcG9pbnQodGhpcy5wdDMsIHRoaXMucHQwKTtcblxuICAgIGxldCB0cmlhbmdsZV9BID0gbmV3IFRyaWFuZ2xlKHB0MCwgcHQwMSwgcHQzMCwgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuICAgIGxldCB0cmlhbmdsZV9CID0gbmV3IFRyaWFuZ2xlKHB0MDEsIHB0MSwgcHQxMiwgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuICAgIGxldCB0cmlhbmdsZV9DID0gbmV3IFRyaWFuZ2xlKHB0MTIsIHB0MiwgcHQyMywgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuICAgIGxldCB0cmlhbmdsZV9EID0gbmV3IFRyaWFuZ2xlKHB0MzAsIHB0MjMsIHB0MywgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuICAgIGxldCBzcXVhcmVfTSA9IG5ldyBTcXVhcmUocHQwMSwgcHQxMiwgcHQyMywgcHQzMCwgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuXG4gICAgcmV0dXJuIFtcbiAgICAgIHRyaWFuZ2xlX0EsXG4gICAgICB0cmlhbmdsZV9CLFxuICAgICAgdHJpYW5nbGVfQyxcbiAgICAgIHRyaWFuZ2xlX0QsXG4gICAgICBzcXVhcmVfTV1cbiAgfVxuXG4gIC8vIHAwICAgICAgICAgICAgICBwMVxuICAvLyBfX19fX19fX19fX19fX19fX1xuICAvLyB8XFwgICAgICAgICAgICAgIHxcbiAgLy8gfCBcXCAgICAgICAgICAgICB8XG4gIC8vIHwgIFxcICAgICAgICAgICAgfFxuICAvLyB8ICAgXFwgICAgICBBICAgIHxcbiAgLy8gfCAgICBcXCAgICAgICAgICB8XG4gIC8vIHwgICAgIFxcICAgICAgICAgfFxuICAvLyB8ICAgICAgXFwgICAgICAgIHxcbiAgLy8gfCAgICAgICBcXCAgICAgICB8XG4gIC8vIHwgICAgICAgIFxcICAgICAgfFxuICAvLyB8ICAgICAgICAgXFwgICAgIHxcbiAgLy8gfCAgICAgICAgICBcXCAgICB8XG4gIC8vIHwgICBCICAgICAgIFxcICAgfFxuICAvLyB8ICAgICAgICAgICAgXFwgIHxcbiAgLy8gfCAgICAgICAgICAgICBcXCB8XG4gIC8vIHwtLS0tLS0tLS0tLS0tLS18IHAyXG4gIC8vIHAzXG4gIGJpc2VjdCgpOiBbVHJpYW5nbGUsIFRyaWFuZ2xlXSB7XG4gICAgbGV0IHB0MCA9IHRoaXMucHQwO1xuICAgIGxldCBwdDEgPSB0aGlzLnB0MTtcbiAgICBsZXQgcHQyID0gdGhpcy5wdDI7XG4gICAgbGV0IHB0MyA9IHRoaXMucHQzO1xuXG4gICAgbGV0IHRyaWFuZ2xlX0EgPSBuZXcgVHJpYW5nbGUocHQwLCBwdDEsIHB0MiwgdGhpcy5taWRwb2ludF93ZWlnaHQpO1xuICAgIGxldCB0cmlhbmdsZV9CID0gbmV3IFRyaWFuZ2xlKHB0MCwgcHQyLCBwdDMsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcblxuICAgIHJldHVybiBbXG4gICAgICB0cmlhbmdsZV9BLFxuICAgICAgdHJpYW5nbGVfQl1cbiAgfVxuXG4gIHN0ZXBfb3B0aW9ucyh1bmlmb3JtX3dlaWdodHM6IGJvb2xlYW4pIHtcbiAgICBpZiAodW5pZm9ybV93ZWlnaHRzKSB7XG4gICAgICByZXR1cm4gNFxuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gNlxuICAgIH1cbiAgfVxuXG4gIG5leHRfc3RlcChpbmRleDogbnVtYmVyLCB1bmlmb3JtX3dlaWdodHM6IGJvb2xlYW4pOiBTaGFwZVtdIHtcbiAgICBpZiAodW5pZm9ybV93ZWlnaHRzKSB7XG4gICAgICBzd2l0Y2ggKGluZGV4KSB7XG4gICAgICAgIGNhc2UgMDpcbiAgICAgICAgICByZXR1cm4gdGhpcy5xdWFkc2VjdCgpXG4gICAgICAgIGNhc2UgMTpcbiAgICAgICAgICByZXR1cm4gdGhpcy5iaXNlY3QoKVxuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgdGhpcy5yb3RhdGUoKTtcbiAgICAgICAgICByZXR1cm4gdGhpcy5iaXNlY3QoKVxuICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCduZXh0X3N0ZXA6IGluZGV4IG91dCBvZiByYW5nZScpXG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN3aXRjaCAoaW5kZXgpIHtcbiAgICAgICAgY2FzZSAwOlxuICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgcmV0dXJuIHRoaXMucXVhZHNlY3QoKVxuICAgICAgICBjYXNlIDI6XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYmlzZWN0KClcbiAgICAgICAgY2FzZSAzOlxuICAgICAgICAgIHRoaXMucm90YXRlKCk7XG4gICAgICAgICAgcmV0dXJuIHRoaXMuYmlzZWN0KClcbiAgICAgICAgY2FzZSA0OlxuICAgICAgICBjYXNlIDU6XG4gICAgICAgICAgcmV0dXJuIFtdXG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCduZXh0X3N0ZXA6IGluZGV4IG91dCBvZiByYW5nZScpXG4gICAgICB9XG4gICAgfVxuICB9XG5cbn1cblxuXG5hc3luYyBmdW5jdGlvbiBtYWluKCkge1xuICBsZXQgcGl4ZWxfc2l6ZSA9IE1hdGgubWluKHdpbmRvdy5pbm5lckhlaWdodCwgd2luZG93LmlubmVyV2lkdGgpO1xuICBjb25zb2xlLmxvZygncGl4ZWwgc2l6ZTonLCBwaXhlbF9zaXplKTtcblxuICBjb25zdCBwdDAgPSBuZXcgUG9pbnQoe3g6IDAsIHk6IHBpeGVsX3NpemV9KTtcbiAgY29uc3QgcHQxID0gbmV3IFBvaW50KHt4OiBwaXhlbF9zaXplLCB5OiBwaXhlbF9zaXplfSk7XG4gIGNvbnN0IHB0MiA9IG5ldyBQb2ludCh7eDogcGl4ZWxfc2l6ZSwgeTogMH0pO1xuICBjb25zdCBwdDMgPSBuZXcgUG9pbnQoe3g6IDAsIHk6IDB9KTtcbiAgY29uc3QgZnJhY3RhbF9zZWVkID0gbmV3IFNxdWFyZShwdDAsIHB0MSwgcHQyLCBwdDMsIHRoaXMubWlkcG9pbnRfd2VpZ2h0KTtcblxuICBjb25zdCB1cmxfcGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh3aW5kb3cubG9jYXRpb24uc2VhcmNoKTtcbiAgdmFyIG1heF9kZXB0aCA9IE51bWJlcih1cmxfcGFyYW1zLmdldCgnZGVwdGgnKSk7XG4gIGlmICghbWF4X2RlcHRoKSB7XG4gICAgbWF4X2RlcHRoID0gM1xuICB9XG4gIHZhciBzdHJva2Vfd2lkdGggPSBOdW1iZXIodXJsX3BhcmFtcy5nZXQoJ3N0cm9rZScpKTtcbiAgaWYgKCFzdHJva2Vfd2lkdGgpIHtcbiAgICBzdHJva2Vfd2lkdGggPSAzXG4gIH1cbiAgY29uc3QgbWlkcG9pbnRfd2VpZ2h0X3BhcmFtID0gdXJsX3BhcmFtcy5nZXQoJ21pZHBvaW50Jyk7XG4gIC8vIHZhciBtaWRwb2ludF93ZWlnaHQgPSBudWxsO1xuICAvLyBpZiAobWlkcG9pbnRfd2VpZ2h0X3BhcmFtICE9IG51bGwpIHtcbiAgLy8gfVxuICBjb25zdCBtaWRwb2ludF93ZWlnaHQgPSBOdW1iZXIobWlkcG9pbnRfd2VpZ2h0X3BhcmFtKVxuICBjb25zdCB1bmlmb3JtX3dlaWdodHNfcGFyYW0gPSB1cmxfcGFyYW1zLmdldCgndW5pZm9ybScpO1xuICBjb25zdCB1bmlmb3JtX3dlaWdodHMgPSAhdW5pZm9ybV93ZWlnaHRzX3BhcmFtIHx8ICh1bmlmb3JtX3dlaWdodHNfcGFyYW0gPT0gJ3QnKTtcblxuICBjb25zb2xlLmxvZygnbWF4X2RlcHRoOicsIG1heF9kZXB0aCk7XG4gIGNvbnNvbGUubG9nKCdzdHJva2Vfd2lkdGg6Jywgc3Ryb2tlX3dpZHRoKTtcbiAgY29uc29sZS5sb2coJ21pZHBvaW50X3dlaWdodDonLCBtaWRwb2ludF93ZWlnaHQpO1xuICBjb25zb2xlLmxvZygndW5pZm9ybV93ZWlnaHRzOicsIHVuaWZvcm1fd2VpZ2h0cyk7XG5cbiAgdmFyIG51bV9zaGFwZXMgPSBmcmFjdGFsX3NlZWQuZnJhY3RhbGl6ZShtYXhfZGVwdGgsIHBpeGVsX3NpemUsIHN0cm9rZV93aWR0aCwgdW5pZm9ybV93ZWlnaHRzLCBtaWRwb2ludF93ZWlnaHQpO1xuICBjb25zb2xlLmxvZygnbnVtX3NoYXBlcycsIG51bV9zaGFwZXMpO1xuICB3aGlsZSAobnVtX3NoYXBlcyA8IDIpIHtcbiAgICAvLyByZW1vdmUgcHJldmlvdXMgU1ZHXG4gICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChkb2N1bWVudC5ib2R5LmNoaWxkcmVuWzBdKTtcblxuICAgIC8vIHJlLWdlbmVyYXRlXG4gICAgbnVtX3NoYXBlcyA9IGZyYWN0YWxfc2VlZC5mcmFjdGFsaXplKG1heF9kZXB0aCwgcGl4ZWxfc2l6ZSwgc3Ryb2tlX3dpZHRoLCB1bmlmb3JtX3dlaWdodHMsIG1pZHBvaW50X3dlaWdodCk7XG4gICAgY29uc29sZS5sb2coJ251bV9zaGFwZXMnLCBudW1fc2hhcGVzKTtcbiAgfVxuXG59XG5cbi8vIHJ1biBtYWluIG9uIGxvYWQgKGFmdGVyIDxib2R5PiBleGlzdHMuLilcbndpbmRvdy5vbmxvYWQgPSBtYWluO1xuXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHR2YXIgY2FjaGVkTW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXTtcblx0aWYgKGNhY2hlZE1vZHVsZSAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0cmV0dXJuIGNhY2hlZE1vZHVsZS5leHBvcnRzO1xuXHR9XG5cdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG5cdHZhciBtb2R1bGUgPSBfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdID0ge1xuXHRcdC8vIG5vIG1vZHVsZS5pZCBuZWVkZWRcblx0XHQvLyBubyBtb2R1bGUubG9hZGVkIG5lZWRlZFxuXHRcdGV4cG9ydHM6IHt9XG5cdH07XG5cblx0Ly8gRXhlY3V0ZSB0aGUgbW9kdWxlIGZ1bmN0aW9uXG5cdF9fd2VicGFja19tb2R1bGVzX19bbW9kdWxlSWRdKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMsIF9fd2VicGFja19yZXF1aXJlX18pO1xuXG5cdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG5cdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbn1cblxuLy8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbl9fd2VicGFja19yZXF1aXJlX18ubSA9IF9fd2VicGFja19tb2R1bGVzX187XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBwcm9wKSkiLCIvLyBubyBiYXNlVVJJXG5cbi8vIG9iamVjdCB0byBzdG9yZSBsb2FkZWQgYW5kIGxvYWRpbmcgY2h1bmtzXG4vLyB1bmRlZmluZWQgPSBjaHVuayBub3QgbG9hZGVkLCBudWxsID0gY2h1bmsgcHJlbG9hZGVkL3ByZWZldGNoZWRcbi8vIFtyZXNvbHZlLCByZWplY3QsIFByb21pc2VdID0gY2h1bmsgbG9hZGluZywgMCA9IGNodW5rIGxvYWRlZFxudmFyIGluc3RhbGxlZENodW5rcyA9IHtcblx0MTc5OiAwXG59O1xuXG4vLyBubyBjaHVuayBvbiBkZW1hbmQgbG9hZGluZ1xuXG4vLyBubyBwcmVmZXRjaGluZ1xuXG4vLyBubyBwcmVsb2FkZWRcblxuLy8gbm8gSE1SXG5cbi8vIG5vIEhNUiBtYW5pZmVzdFxuXG5fX3dlYnBhY2tfcmVxdWlyZV9fLk8uaiA9IChjaHVua0lkKSA9PiAoaW5zdGFsbGVkQ2h1bmtzW2NodW5rSWRdID09PSAwKTtcblxuLy8gaW5zdGFsbCBhIEpTT05QIGNhbGxiYWNrIGZvciBjaHVuayBsb2FkaW5nXG52YXIgd2VicGFja0pzb25wQ2FsbGJhY2sgPSAocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24sIGRhdGEpID0+IHtcblx0dmFyIFtjaHVua0lkcywgbW9yZU1vZHVsZXMsIHJ1bnRpbWVdID0gZGF0YTtcblx0Ly8gYWRkIFwibW9yZU1vZHVsZXNcIiB0byB0aGUgbW9kdWxlcyBvYmplY3QsXG5cdC8vIHRoZW4gZmxhZyBhbGwgXCJjaHVua0lkc1wiIGFzIGxvYWRlZCBhbmQgZmlyZSBjYWxsYmFja1xuXHR2YXIgbW9kdWxlSWQsIGNodW5rSWQsIGkgPSAwO1xuXHRpZihjaHVua0lkcy5zb21lKChpZCkgPT4gKGluc3RhbGxlZENodW5rc1tpZF0gIT09IDApKSkge1xuXHRcdGZvcihtb2R1bGVJZCBpbiBtb3JlTW9kdWxlcykge1xuXHRcdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKG1vcmVNb2R1bGVzLCBtb2R1bGVJZCkpIHtcblx0XHRcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tW21vZHVsZUlkXSA9IG1vcmVNb2R1bGVzW21vZHVsZUlkXTtcblx0XHRcdH1cblx0XHR9XG5cdFx0aWYocnVudGltZSkgdmFyIHJlc3VsdCA9IHJ1bnRpbWUoX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cdH1cblx0aWYocGFyZW50Q2h1bmtMb2FkaW5nRnVuY3Rpb24pIHBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uKGRhdGEpO1xuXHRmb3IoO2kgPCBjaHVua0lkcy5sZW5ndGg7IGkrKykge1xuXHRcdGNodW5rSWQgPSBjaHVua0lkc1tpXTtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oaW5zdGFsbGVkQ2h1bmtzLCBjaHVua0lkKSAmJiBpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0pIHtcblx0XHRcdGluc3RhbGxlZENodW5rc1tjaHVua0lkXVswXSgpO1xuXHRcdH1cblx0XHRpbnN0YWxsZWRDaHVua3NbY2h1bmtJZF0gPSAwO1xuXHR9XG5cdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fLk8ocmVzdWx0KTtcbn1cblxudmFyIGNodW5rTG9hZGluZ0dsb2JhbCA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtzcXVhcmVfZnJhY3RhbFwiXSA9IHNlbGZbXCJ3ZWJwYWNrQ2h1bmtzcXVhcmVfZnJhY3RhbFwiXSB8fCBbXTtcbmNodW5rTG9hZGluZ0dsb2JhbC5mb3JFYWNoKHdlYnBhY2tKc29ucENhbGxiYWNrLmJpbmQobnVsbCwgMCkpO1xuY2h1bmtMb2FkaW5nR2xvYmFsLnB1c2ggPSB3ZWJwYWNrSnNvbnBDYWxsYmFjay5iaW5kKG51bGwsIGNodW5rTG9hZGluZ0dsb2JhbC5wdXNoLmJpbmQoY2h1bmtMb2FkaW5nR2xvYmFsKSk7IiwiLy8gc3RhcnR1cFxuLy8gTG9hZCBlbnRyeSBtb2R1bGUgYW5kIHJldHVybiBleHBvcnRzXG4vLyBUaGlzIGVudHJ5IG1vZHVsZSBkZXBlbmRzIG9uIG90aGVyIGxvYWRlZCBjaHVua3MgYW5kIGV4ZWN1dGlvbiBuZWVkIHRvIGJlIGRlbGF5ZWRcbnZhciBfX3dlYnBhY2tfZXhwb3J0c19fID0gX193ZWJwYWNrX3JlcXVpcmVfXy5PKHVuZGVmaW5lZCwgWzUwMF0sICgpID0+IChfX3dlYnBhY2tfcmVxdWlyZV9fKDQxNykpKVxuX193ZWJwYWNrX2V4cG9ydHNfXyA9IF9fd2VicGFja19yZXF1aXJlX18uTyhfX3dlYnBhY2tfZXhwb3J0c19fKTtcbiJdLCJuYW1lcyI6WyJkZWZlcnJlZCIsIm1pZHBvaW50IiwieHMiLCJ5cyIsInRoaXMiLCJtaWRwb2ludF93ZWlnaHQiLCJjb25zb2xlIiwibG9nIiwieCIsInkiLCJyZW5kZXJfcG9pbnRhcnJheSIsInJlbmRlciIsImZsYXRNYXAiLCJwdCIsImZyYWN0YWxpemUiLCJtYXhfZGVwdGgiLCJwaXhlbF9zaXplIiwic3Ryb2tlX3dpZHRoIiwidW5pZm9ybV93ZWlnaHRzIiwiZHJhdyIsImFkZFRvIiwic2l6ZSIsInBvbHlsaW5lIiwiZmlsbCIsInN0cm9rZSIsImNvbG9yIiwid2lkdGgiLCJudW1fc3ViX3NoYXBlcyIsInVuZmluaXNoZWRfc2hhcGVzIiwicG9wIiwiY3VycmVudF9zaGFwZSIsImN1cnJlbnRfZGVwdGgiLCJuZXh0X3JhbmRvbV9udW0iLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJVaW50MzJBcnJheSIsIm1heCIsInN0ZXBfb3B0aW9ucyIsIm5leHRfc3RlcF9pbmRleCIsIk1hdGgiLCJmbG9vciIsInB1c2giLCJuZXh0X3N0ZXAiLCJtYXAiLCJsZW5ndGgiLCJwdDAiLCJwdDEiLCJwdDIiLCJyb3RhdGUiLCJwb2ludHMiLCJ0cmlzZWN0IiwicHQwMSIsInB0MTIiLCJwdDIwIiwiVHJpYW5nbGUiLCJ0X3NwbGl0IiwicHQyMDEiLCJRdWFkcmlsYXRlcmFsIiwiaW5kZXgiLCJFcnJvciIsIlNoYXBlIiwicHQzIiwicXVhZHNlY3QiLCJwdDIzIiwicHQzMCIsIlNxdWFyZSIsImJpc2VjdCIsIndpbmRvdyIsIm9ubG9hZCIsIm1pbiIsImlubmVySGVpZ2h0IiwiaW5uZXJXaWR0aCIsImZyYWN0YWxfc2VlZCIsInVybF9wYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJsb2NhdGlvbiIsInNlYXJjaCIsIk51bWJlciIsImdldCIsIm1pZHBvaW50X3dlaWdodF9wYXJhbSIsInVuaWZvcm1fd2VpZ2h0c19wYXJhbSIsIm51bV9zaGFwZXMiLCJkb2N1bWVudCIsImJvZHkiLCJyZW1vdmVDaGlsZCIsImNoaWxkcmVuIiwiX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiY2FjaGVkTW9kdWxlIiwidW5kZWZpbmVkIiwiZXhwb3J0cyIsIm1vZHVsZSIsIl9fd2VicGFja19tb2R1bGVzX18iLCJtIiwiTyIsInJlc3VsdCIsImNodW5rSWRzIiwiZm4iLCJwcmlvcml0eSIsIm5vdEZ1bGZpbGxlZCIsIkluZmluaXR5IiwiaSIsImZ1bGZpbGxlZCIsImoiLCJPYmplY3QiLCJrZXlzIiwiZXZlcnkiLCJrZXkiLCJzcGxpY2UiLCJyIiwiZCIsImRlZmluaXRpb24iLCJvIiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwib2JqIiwicHJvcCIsInByb3RvdHlwZSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImluc3RhbGxlZENodW5rcyIsImNodW5rSWQiLCJ3ZWJwYWNrSnNvbnBDYWxsYmFjayIsInBhcmVudENodW5rTG9hZGluZ0Z1bmN0aW9uIiwiZGF0YSIsIm1vcmVNb2R1bGVzIiwicnVudGltZSIsInNvbWUiLCJpZCIsImNodW5rTG9hZGluZ0dsb2JhbCIsInNlbGYiLCJmb3JFYWNoIiwiYmluZCIsIl9fd2VicGFja19leHBvcnRzX18iXSwic291cmNlUm9vdCI6IiJ9